{% extends 'shared/layout.html' %}
<!-- Citation: https://stackoverflow.com/questions/2554149/how-can-i-change-div-content-with-javascript -->
{% block extrajs %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

{% endblock %}


{% block maincontent %}
<br><br>
<div class="Login">
    <input type="text" id="email" placeholder="email" name="email" title="Email of user"> 
    <input type="text" id="password" placeholder="password" name="password" title="Password of user"> 
    <button onclick="checkCredentials()">Login</button>
    <div> Count Attempts: <span id="count"> 0 </span> </div>
</div>


<script>
let count     = 0

function checkCredentials() {
    // package data in a JSON object
    const email = document.querySelector("#email");
    const feedback = document.querySelector("#password");
    // owner@email.com
    // password
    var data_d = {'email': email.value, 'password': feedback.value}
    console.log('data_d', data_d);
    
    // SEND DATA TO SERVER VIA jQuery.ajax({})
    jQuery.ajax({
        url: "/processlogin",
        data: data_d,
        type: "POST",
        success:function(retruned_data){
              retruned_data = JSON.parse(retruned_data);

              if (retruned_data["success"] == 1) {
                window.location.href = "/home";
                count = 0;
              } else {
                count += 1
                console.log(count);
              }
              document.querySelector("#count").innerHTML = count;              
            } 
    });
}
</script>
{% endblock %}


